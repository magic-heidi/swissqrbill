(function(_,e){typeof exports=="object"&&typeof module!="undefined"?e(exports):typeof define=="function"&&define.amd?define(["exports"],e):(_=typeof globalThis!="undefined"?globalThis:_||self,e(_.SwissQRBill={}))})(this,function(exports){"use strict";var wt=Object.defineProperty,xt=Object.defineProperties;var Vt=Object.getOwnPropertyDescriptors;var ft=Object.getOwnPropertySymbols;var vt=Object.prototype.hasOwnProperty,Lt=Object.prototype.propertyIsEnumerable;var ct=(_,e,t)=>e in _?wt(_,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):_[e]=t,$=(_,e)=>{for(var t in e||(e={}))vt.call(e,t)&&ct(_,t,e[t]);if(ft)for(var t of ft(e))Lt.call(e,t)&&ct(_,t,e[t]);return _},O=(_,e)=>xt(_,Vt(e));var _;function cleanData(e){const t=i=>Object.fromEntries(Object.entries(i).map(([n,r])=>typeof r=="object"?[n,t(r)]:typeof r=="string"?n==="account"?[n,removeLineBreaks(removeSpaces(r))]:n==="reference"?[n,removeLineBreaks(removeSpaces(r))]:n==="country"?[n,removeLineBreaks(removeSpaces(r).toUpperCase())]:[n,removeLineBreaks(r)]:[n,r]));return t(e)}function removeSpaces(e){return e.replace(/ /g,"")}function removeLineBreaks(e){return e.replace(/\n/g,"").replace(/\r/g,"")}const translations={DE:{acceptancePoint:"Annahmestelle",account:"Konto / Zahlbar an",additionalInformation:"Zusätzliche Informationen",amount:"Betrag",currency:"Währung",inFavourOf:"Zugunsten",payableBy:"Zahlbar durch",payableByName:"Zahlbar durch (Name/Adresse)",paymentPart:"Zahlteil",receipt:"Empfangsschein",reference:"Referenz",separate:"Vor der Einzahlung abzutrennen"},EN:{acceptancePoint:"Acceptance point",account:"Account / Payable to",additionalInformation:"Additional information",amount:"Amount",currency:"Currency",inFavourOf:"In favour of",payableBy:"Payable by",payableByName:"Payable by (name/address)",paymentPart:"Payment part",receipt:"Receipt",reference:"Reference",separate:"Separate before paying in"},FR:{acceptancePoint:"Point de dépôt",account:"Compte / Payable à",additionalInformation:"Informations supplémentaires",amount:"Montant",currency:"Monnaie",inFavourOf:"En faveur de",payableBy:"Payable par",payableByName:"Payable par (nom/adresse)",paymentPart:"Section paiement",receipt:"Récépissé",reference:"Référence",separate:"A détacher avant le versement"},IT:{acceptancePoint:"Punto di accettazione",account:"Conto / Pagabile a",additionalInformation:"Informazioni supplementari",amount:"Importo",currency:"Valuta",inFavourOf:"A favore di",payableBy:"Pagabile da",payableByName:"Pagabile da (nome/indirizzo)",paymentPart:"Sezione pagamento",receipt:"Ricevuta",reference:"Riferimento",separate:"Da staccare prima del versamento"}};class ValidationError extends Error{constructor(t,i){const n=i?resolveMessageParams(t,i):t;super(n),this.name="ValidationError",this.code=getErrorCodeByMessage(t)}}function getErrorCodeByMessage(e){return Object.keys(ValidationErrors).find(n=>ValidationErrors[n]===e)}function resolveMessageParams(e,t){return Object.entries(t).reduce((i,[n,r])=>i.replace(`{${n}}`,r),e)}var ValidationErrors=(e=>(e.ACCOUNT_IS_QR_IBAN_BUT_REFERENCE_IS_MISSING="If there is no reference, a conventional IBAN must be used.",e.ACCOUNT_IS_QR_IBAN_BUT_REFERENCE_IS_REGULAR="QR-IBAN requires the use of a QR-Reference.",e.ACCOUNT_IS_REGULAR_IBAN_BUT_REFERENCE_IS_QR="QR-Reference requires the use of a QR-IBAN.",e.ACCOUNT_LENGTH_IS_INVALID="The provided IBAN number '{iban}' is either too long or too short.",e.ADDITIONAL_INFORMATION_LENGTH_IS_INVALID="Additional information must be a maximum of 140 characters.",e.ADDITIONAL_INFORMATION_TYPE_IS_INVALID="Additional information must be a string.",e.ALTERNATIVE_SCHEME_LENGTH_IS_INVALID="{scheme} must be a maximum of 100 characters.",e.ALTERNATIVE_SCHEME_TYPE_IS_INVALID="{scheme} must be a string.",e.AMOUNT_LENGTH_IS_INVALID="Amount must be a maximum of 12 digits.",e.AMOUNT_TYPE_IS_INVALID="Amount must be a number.",e.CREDITOR_ACCOUNT_COUNTRY_IS_INVALID="Only CH and LI IBAN numbers are allowed.",e.CREDITOR_ACCOUNT_IS_INVALID="The provided IBAN number '{iban}' is not valid.",e.CREDITOR_ACCOUNT_IS_UNDEFINED="Creditor account cannot be undefined.",e.CREDITOR_ADDRESS_IS_UNDEFINED="Creditor address cannot be undefined.",e.CREDITOR_ADDRESS_LENGTH_IS_INVALID="Creditor address must be a maximum of 70 characters.",e.CREDITOR_ADDRESS_TYPE_IS_INVALID="Creditor address TYPE must be a string.",e.CREDITOR_BUILDING_NUMBER_LENGTH_IS_INVALID="Creditor buildingNumber must be a maximum of 16 characters.",e.CREDITOR_BUILDING_NUMBER_TYPE_IS_INVALID="Creditor buildingNumber must be either a string or a number.",e.CREDITOR_CITY_IS_UNDEFINED="Creditor city cannot be undefined.",e.CREDITOR_CITY_LENGTH_IS_INVALID="Creditor city must be a maximum of 35 characters.",e.CREDITOR_CITY_TYPE_IS_INVALID="Creditor city must be a string.",e.CREDITOR_COUNTRY_IS_UNDEFINED="Creditor country cannot be undefined.",e.CREDITOR_COUNTRY_LENGTH_IS_INVALID="Creditor country must be 2 characters.",e.CREDITOR_COUNTRY_TYPE_IS_INVALID="Creditor country must be a string.",e.CREDITOR_IS_UNDEFINED="Creditor cannot be undefined.",e.CREDITOR_NAME_IS_UNDEFINED="Creditor name cannot be undefined.",e.CREDITOR_NAME_LENGTH_IS_INVALID="Creditor name must be a maximum of 70 characters.",e.CREDITOR_NAME_TYPE_IS_INVALID="Creditor name must be a string.",e.CREDITOR_ZIP_IS_UNDEFINED="Creditor zip cannot be undefined.",e.CREDITOR_ZIP_LENGTH_IS_INVALID="Creditor zip must be a maximum of 16 characters.",e.CREDITOR_ZIP_TYPE_IS_INVALID="Creditor zip must be either a string or a number.",e.CURRENCY_IS_UNDEFINED="Currency cannot be undefined.",e.CURRENCY_LENGTH_IS_INVALID="Currency must be a length of 3 characters.",e.CURRENCY_STRING_IS_INVALID="Currency must be 'CHF' or 'EUR' or 'GBP' or 'USD'.",e.CURRENCY_TYPE_IS_INVALID="Currency must be a string.",e.DEBTOR_ADDRESS_IS_UNDEFINED="Debtor address cannot be undefined.",e.DEBTOR_ADDRESS_LENGTH_IS_INVALID="Debtor address must be a maximum of 70 characters.",e.DEBTOR_ADDRESS_TYPE_IS_INVALID="Debtor address TYPE must be a string.",e.DEBTOR_BUILDING_NUMBER_LENGTH_IS_INVALID="Debtor buildingNumber must be a maximum of 16 characters.",e.DEBTOR_BUILDING_NUMBER_TYPE_IS_INVALID="Debtor buildingNumber must be either a string or a number.",e.DEBTOR_CITY_IS_UNDEFINED="Debtor city cannot be undefined.",e.DEBTOR_CITY_LENGTH_IS_INVALID="Debtor city must be a maximum of 35 characters.",e.DEBTOR_CITY_TYPE_IS_INVALID="Debtor city must be a string.",e.DEBTOR_COUNTRY_IS_UNDEFINED="Debtor country cannot be undefined.",e.DEBTOR_COUNTRY_LENGTH_IS_INVALID="Debtor country must be 2 characters.",e.DEBTOR_COUNTRY_TYPE_IS_INVALID="Debtor country must be a string.",e.DEBTOR_IS_UNDEFINED="Debtor cannot be undefined.",e.DEBTOR_NAME_IS_UNDEFINED="Debtor name cannot be undefined.",e.DEBTOR_NAME_LENGTH_IS_INVALID="Debtor name must be a maximum of 70 characters.",e.DEBTOR_NAME_TYPE_IS_INVALID="Debtor name must be a string.",e.DEBTOR_ZIP_IS_UNDEFINED="Debtor zip cannot be undefined.",e.DEBTOR_ZIP_LENGTH_IS_INVALID="Debtor zip must be a maximum of 16 characters.",e.DEBTOR_ZIP_TYPE_IS_INVALID="Debtor zip must be either a string or a number.",e.MESSAGE_AND_ADDITIONAL_INFORMATION_LENGTH_IS_INVALID="Message and additionalInformation combined must be a maximum of 140 characters.",e.MESSAGE_LENGTH_IS_INVALID="Message must be a maximum of 140 characters.",e.MESSAGE_TYPE_IS_INVALID="Message must be a string.",e.QR_REFERENCE_IS_INVALID="The provided QR-Reference '{reference}' is not valid.",e.QR_REFERENCE_LENGTH_IS_INVALID="QR-Reference must be a must be exactly 27 characters.",e.REFERENCE_TYPE_IS_INVALID="Reference must be a string.",e.REGULAR_REFERENCE_LENGTH_IS_INVALID="Creditor reference must be a maximum of 25 characters.",e))(ValidationErrors||{});const errors=Object.freeze(Object.defineProperty({__proto__:null,ValidationError,ValidationErrors,getErrorCodeByMessage,resolveMessageParams},Symbol.toStringTag,{value:"Module"}));function isQRIBAN(e){e=e.replace(/ /g,"");const t=e.substring(4,9);return+t>=3e4&&+t<=31999}function isIBANValid(e){return e=e.replace(/ /g,"").toUpperCase(),e=e.substring(4)+e.substring(0,4),mod97(e)===1}function formatIBAN(e){var i;const t=e.replace(/ /g,"").match(/.{1,4}/g);return(i=t==null?void 0:t.join(" "))!=null?i:e}function isQRReference(e){return e=e.replace(/ /g,""),!(e.length!==27||!/^\d+$/.test(e))}function isQRReferenceValid(e){if(e=e.replace(/ /g,""),!isQRReference(e))return!1;const t=e.substring(0,26),i=e.substring(26,27);return calculateQRReferenceChecksum(t)===i}function isSCORReference(e){return e=e.replace(/ /g,"").toUpperCase(),!(!e.startsWith("RF")||e.length<5||e.length>25||!/^[\dA-Z]+$/.test(e))}function isSCORReferenceValid(e){if(e=e.replace(/ /g,""),!isSCORReference(e))return!1;const t=e.substring(4);if(Number.isNaN(e))return!1;const i=e.substring(2,4);return Number.isNaN(i)?!1:calculateSCORReferenceChecksum(t)===i}function calculateSCORReferenceChecksum(e){return e=e.replace(/ /g,""),`${98-mod97(`${e}RF00`)}`.padStart(2,"0")}function calculateQRReferenceChecksum(e){return mod10(e)}function formatQRReference(e){const t=e.replace(/ /g,""),i=t.substring(2).match(/.{1,5}/g);return i?`${t.substring(0,2)} ${i.join(" ")}`:e}function formatSCORReference(e){var n;const i=e.replace(/ /g,"").match(/.{1,4}/g);return(n=i==null?void 0:i.join(" "))!=null?n:e}function formatReference(e){const t=getReferenceType(e);return t==="QRR"?formatQRReference(e):t==="SCOR"?formatSCORReference(e):e}function formatAmount(e,t){if(t)return new Intl.NumberFormat(t,{maximumFractionDigits:2,minimumFractionDigits:2,signDisplay:"auto",style:"decimal",useGrouping:!0}).format(e);const n=e.toFixed(2).split(".");let r="";for(let l=n[0].length-1,f=1;l>=0;l--,f++)r=n[0][l]+r,f===3&&(r=` ${r}`,f=0);return`${r.trim()}.${n[1]}`}function mm2pt(e){return e*2.83465}function pt2mm(e){return e/2.83465}function mm2px$1(e){return e*960/254}function px2mm$1(e){return e*254/960}function getReferenceType(e){return typeof e=="undefined"?"NON":isQRReference(e)?"QRR":"SCOR"}function mod97(e){const i=e.split("");for(let r=0;r<i.length;r++){const l=i[r].charCodeAt(0);l>=65&&(i[r]=`${l-65+10}`)}e=i.join("");let n=0;for(let r=0;r<e.length;r++){const l=+e[r];n=(10*n+l)%97}return n}function mod10(e){const t=e.replace(/ /g,""),i=[0,9,4,6,8,2,7,1,3,5];let n=0;for(let r=0;r<t.length;r++)n=i[(n+parseInt(t.substring(r,r+1),10))%10];return((10-n)%10).toString()}const utils=Object.freeze(Object.defineProperty({__proto__:null,calculateQRReferenceChecksum,calculateSCORReferenceChecksum,formatAmount,formatIBAN,formatQRReference,formatReference,formatSCORReference,getReferenceType,isIBANValid,isQRIBAN,isQRReference,isQRReferenceValid,isSCORReference,isSCORReferenceValid,mm2pt,mm2px:mm2px$1,pt2mm,px2mm:px2mm$1},Symbol.toStringTag,{value:"Module"}));function validateData(e){if(e.reference!==void 0&&typeof e.reference!="string")throw new ValidationError(ValidationErrors.REFERENCE_TYPE_IS_INVALID);if(e.message!==void 0){if(typeof e.message!="string")throw new ValidationError(ValidationErrors.MESSAGE_TYPE_IS_INVALID);if(e.message.length>140)throw new ValidationError(ValidationErrors.MESSAGE_LENGTH_IS_INVALID)}if(e.additionalInformation!==void 0){if(typeof e.additionalInformation!="string")throw new ValidationError(ValidationErrors.ADDITIONAL_INFORMATION_TYPE_IS_INVALID);if(e.additionalInformation.length>140)throw new ValidationError(ValidationErrors.ADDITIONAL_INFORMATION_LENGTH_IS_INVALID)}if(e.message!==void 0&&e.additionalInformation!==void 0&&e.additionalInformation.length+e.message.length>140)throw new ValidationError(ValidationErrors.MESSAGE_AND_ADDITIONAL_INFORMATION_LENGTH_IS_INVALID);if(e.av1!==void 0){if(typeof e.av1!="string")throw new ValidationError(ValidationErrors.ALTERNATIVE_SCHEME_TYPE_IS_INVALID,{scheme:"AV1"});if(e.av1.length>100)throw new ValidationError(ValidationErrors.ALTERNATIVE_SCHEME_LENGTH_IS_INVALID,{scheme:"AV1"})}if(e.av2!==void 0){if(typeof e.av2!="string")throw new ValidationError(ValidationErrors.ALTERNATIVE_SCHEME_TYPE_IS_INVALID,{scheme:"AV2"});if(e.av2.length>100)throw new ValidationError(ValidationErrors.ALTERNATIVE_SCHEME_LENGTH_IS_INVALID,{scheme:"AV2"})}if(e.creditor===void 0)throw new ValidationError(ValidationErrors.CREDITOR_IS_UNDEFINED);if(e.creditor.account===void 0)throw new ValidationError(ValidationErrors.CREDITOR_ACCOUNT_IS_UNDEFINED);if(!e.creditor.account.startsWith("CH")&&!e.creditor.account.startsWith("LI"))throw new ValidationError(ValidationErrors.CREDITOR_ACCOUNT_COUNTRY_IS_INVALID);if(e.creditor.account.length!==21)throw new ValidationError(ValidationErrors.ACCOUNT_LENGTH_IS_INVALID,{iban:e.creditor.account});if(e.creditor.name===void 0)throw new ValidationError(ValidationErrors.CREDITOR_NAME_IS_UNDEFINED);if(typeof e.creditor.name!="string")throw new ValidationError(ValidationErrors.CREDITOR_NAME_TYPE_IS_INVALID);if(e.creditor.name.length>70)throw new ValidationError(ValidationErrors.CREDITOR_NAME_LENGTH_IS_INVALID);if(e.creditor.address===void 0)throw new ValidationError(ValidationErrors.CREDITOR_ADDRESS_IS_UNDEFINED);if(typeof e.creditor.address!="string")throw new ValidationError(ValidationErrors.CREDITOR_ADDRESS_TYPE_IS_INVALID);if(e.creditor.address.length>70)throw new ValidationError(ValidationErrors.CREDITOR_ADDRESS_LENGTH_IS_INVALID);if(e.creditor.buildingNumber!==void 0){if(typeof e.creditor.buildingNumber!="string"&&typeof e.creditor.buildingNumber!="number")throw new ValidationError(ValidationErrors.CREDITOR_BUILDING_NUMBER_TYPE_IS_INVALID);if(e.creditor.buildingNumber.toString().length>16)throw new ValidationError(ValidationErrors.CREDITOR_BUILDING_NUMBER_LENGTH_IS_INVALID)}if(e.creditor.zip===void 0)throw new ValidationError(ValidationErrors.CREDITOR_ZIP_IS_UNDEFINED);if(typeof e.creditor.zip!="string"&&typeof e.creditor.zip!="number")throw new ValidationError(ValidationErrors.CREDITOR_ZIP_TYPE_IS_INVALID);if(e.creditor.zip.toString().length>16)throw new ValidationError(ValidationErrors.CREDITOR_ZIP_LENGTH_IS_INVALID);if(e.creditor.city===void 0)throw new ValidationError(ValidationErrors.CREDITOR_CITY_IS_UNDEFINED);if(typeof e.creditor.city!="string")throw new ValidationError(ValidationErrors.CREDITOR_CITY_TYPE_IS_INVALID);if(e.creditor.city.length>35)throw new ValidationError(ValidationErrors.CREDITOR_CITY_LENGTH_IS_INVALID);if(e.creditor.country===void 0)throw new ValidationError(ValidationErrors.CREDITOR_COUNTRY_IS_UNDEFINED);if(typeof e.creditor.country!="string")throw new ValidationError(ValidationErrors.CREDITOR_COUNTRY_TYPE_IS_INVALID);if(e.creditor.country.length!==2)throw new ValidationError(ValidationErrors.CREDITOR_COUNTRY_LENGTH_IS_INVALID);if(e.amount!==void 0){if(typeof e.amount!="number")throw new ValidationError(ValidationErrors.AMOUNT_TYPE_IS_INVALID);if(e.amount.toFixed(2).toString().length>12)throw new ValidationError(ValidationErrors.AMOUNT_LENGTH_IS_INVALID)}if(e.currency===void 0)throw new ValidationError(ValidationErrors.CURRENCY_IS_UNDEFINED);if(typeof e.currency!="string")throw new ValidationError(ValidationErrors.CURRENCY_TYPE_IS_INVALID);if(e.currency.length!==3)throw new ValidationError(ValidationErrors.CURRENCY_LENGTH_IS_INVALID);if(e.currency!=="CHF"&&e.currency!=="EUR"&&e.currency!=="GBP"&&e.currency!=="USD")throw new ValidationError(ValidationErrors.CURRENCY_STRING_IS_INVALID);if(e.debtor!==void 0){if(e.debtor.name===void 0)throw new ValidationError(ValidationErrors.DEBTOR_NAME_IS_UNDEFINED);if(typeof e.debtor.name!="string")throw new ValidationError(ValidationErrors.DEBTOR_NAME_TYPE_IS_INVALID);if(e.debtor.name.length>70)throw new ValidationError(ValidationErrors.DEBTOR_NAME_LENGTH_IS_INVALID);if(e.debtor.address===void 0)throw new ValidationError(ValidationErrors.DEBTOR_ADDRESS_IS_UNDEFINED);if(typeof e.debtor.address!="string")throw new ValidationError(ValidationErrors.DEBTOR_ADDRESS_TYPE_IS_INVALID);if(e.debtor.address.length>70)throw new ValidationError(ValidationErrors.DEBTOR_ADDRESS_LENGTH_IS_INVALID);if(e.debtor.buildingNumber!==void 0){if(typeof e.debtor.buildingNumber!="string"&&typeof e.debtor.buildingNumber!="number")throw new ValidationError(ValidationErrors.DEBTOR_BUILDING_NUMBER_TYPE_IS_INVALID);if(e.debtor.buildingNumber.toString().length>16)throw new ValidationError(ValidationErrors.DEBTOR_BUILDING_NUMBER_LENGTH_IS_INVALID)}if(e.debtor.zip===void 0)throw new ValidationError(ValidationErrors.DEBTOR_ZIP_IS_UNDEFINED);if(typeof e.debtor.zip!="string"&&typeof e.debtor.zip!="number")throw new ValidationError(ValidationErrors.DEBTOR_ZIP_TYPE_IS_INVALID);if(e.debtor.zip.toString().length>16)throw new ValidationError(ValidationErrors.DEBTOR_ZIP_LENGTH_IS_INVALID);if(e.debtor.city===void 0)throw new ValidationError(ValidationErrors.DEBTOR_CITY_IS_UNDEFINED);if(typeof e.debtor.city!="string")throw new ValidationError(ValidationErrors.DEBTOR_CITY_TYPE_IS_INVALID);if(e.debtor.city.length>35)throw new ValidationError(ValidationErrors.DEBTOR_CITY_LENGTH_IS_INVALID);if(e.debtor.country===void 0)throw new ValidationError(ValidationErrors.DEBTOR_COUNTRY_IS_UNDEFINED);if(typeof e.debtor.country!="string")throw new ValidationError(ValidationErrors.DEBTOR_COUNTRY_TYPE_IS_INVALID);if(e.debtor.country.length!==2)throw new ValidationError(ValidationErrors.DEBTOR_COUNTRY_LENGTH_IS_INVALID)}if(isIBANValid(e.creditor.account)===!1)throw new ValidationError(ValidationErrors.CREDITOR_ACCOUNT_IS_INVALID,{iban:e.creditor.account});if(isQRIBAN(e.creditor.account)){if(e.reference===void 0)throw new ValidationError(ValidationErrors.ACCOUNT_IS_QR_IBAN_BUT_REFERENCE_IS_MISSING);if(e.reference.length!==27)throw new ValidationError(ValidationErrors.QR_REFERENCE_LENGTH_IS_INVALID);if(isQRReference(e.reference)){if(!isQRReferenceValid(e.reference))throw new ValidationError(ValidationErrors.QR_REFERENCE_IS_INVALID,{reference:e.reference})}else throw new ValidationError(ValidationErrors.ACCOUNT_IS_QR_IBAN_BUT_REFERENCE_IS_REGULAR)}else if(e.reference!==void 0){if(isQRReference(e.reference))throw new ValidationError(ValidationErrors.ACCOUNT_IS_REGULAR_IBAN_BUT_REFERENCE_IS_QR);if(e.reference.length>25)throw new ValidationError(ValidationErrors.REGULAR_REFERENCE_LENGTH_IS_INVALID)}}let SwissQRBill$1=(_=class{constructor(t,i){this.scissors=!0,this.separate=!1,this.outlines=!0,this.language="DE",this.font="Helvetica",this._x=0,this._y=0,this.data=cleanData(t),validateData(this.data),this.language=(i==null?void 0:i.language)!==void 0?i.language:this.language,this.outlines=(i==null?void 0:i.outlines)!==void 0?i.outlines:this.outlines,this.font=(i==null?void 0:i.fontName)!==void 0?i.fontName:this.font,(i==null?void 0:i.scissors)!==void 0&&(this.scissors=i.scissors,this.separate=!i.scissors),(i==null?void 0:i.separate)!==void 0&&(this.separate=i.separate,this.scissors=!i.separate),(i==null?void 0:i.scissors)===!1&&(i==null?void 0:i.separate)===!1&&(this.separate=!1,this.scissors=!1)}attachTo(t,i=0,n=(r=>(r=t.page)==null?void 0:r.height)()?(l=>(l=t.page)==null?void 0:l.height)()-mm2pt(105):0){_.isSpaceSufficient(t,i,n)||(t.addPage({margin:0,size:[_.width,_.height]}),i=0,n=0),this._x=i,this._y=n,this.render(t)}static isSpaceSufficient(t,i,n){return t.page?Math.round(i+_.width)<=Math.round(t.page.width)&&Math.round(t.y+_.height)<=Math.round(t.page.height)&&Math.round(n+_.height)<=Math.round(t.page.height):!1}x(t=0){return this._x+mm2pt(t)}y(t=0){return this._y+mm2pt(t)}render(t){if(this.outlines&&(t.page.height>mm2pt(105)&&t.moveTo(this.x(),this.y()).lineTo(this.x(210),this.y()).lineWidth(.75).strokeOpacity(1).dash(1,{size:1}).strokeColor("black").stroke(),t.moveTo(this.x(62),this.y()).lineTo(this.x(62),this.y(105)).lineWidth(.75).strokeOpacity(1).dash(1,{size:1}).strokeColor("black").stroke()),this.scissors){const r="4.545 -1.803 m 4.06 -2.388 3.185 -2.368 2.531 -2.116 c -1.575 -0.577 l -2.769 -1.23 -3.949 -1.043 -3.949 -1.361 c -3.949 -1.61 -3.721 -1.555 -3.755 -2.203 c -3.788 -2.825 -4.437 -3.285 -5.05 -3.244 c -5.664 -3.248 -6.3 -2.777 -6.305 -2.129 c -6.351 -1.476 -5.801 -0.869 -5.152 -0.826 c -4.391 -0.713 -3.043 -1.174 -2.411 -0.041 c -2.882 0.828 -3.718 0.831 -4.474 0.787 c -5.101 0.751 -5.855 0.931 -6.154 1.547 c -6.443 2.138 -6.16 2.979 -5.496 3.16 c -4.826 3.406 -3.906 3.095 -3.746 2.325 c -3.623 1.731 -4.044 1.452 -3.882 1.236 c -3.76 1.073 -2.987 1.168 -1.608 0.549 c 2.838 2.117 l 3.4 2.273 4.087 2.268 4.584 1.716 c -0.026 -0.027 l 4.545 -1.803 l h -4.609 -2.753 m -3.962 -2.392 -4.015 -1.411 -4.687 -1.221 c -5.295 -1.009 -6.073 -1.6 -5.879 -2.26 c -5.765 -2.801 -5.052 -3 -4.609 -2.753 c h -4.581 1.256 m -3.906 1.505 -4.02 2.648 -4.707 2.802 c -5.163 2.96 -5.814 2.733 -5.86 2.196 c -5.949 1.543 -5.182 0.954 -4.581 1.256 c h",l=" 1.803 4.545 m 2.388 4.06 2.368 3.185 2.116 2.531 c 0.577 -1.575 l 1.23 -2.769 1.043 -3.949 1.361 -3.949 c 1.61 -3.949 1.555 -3.721 2.203 -3.755 c 2.825 -3.788 3.285 -4.437 3.244 -5.05 c 3.248 -5.664 2.777 -6.3 2.129 -6.305 c 1.476 -6.351 0.869 -5.801 0.826 -5.152 c 0.713 -4.391 1.174 -3.043 0.041 -2.411 c -0.828 -2.882 -0.831 -3.718 -0.787 -4.474 c -0.751 -5.101 -0.931 -5.855 -1.547 -6.154 c -2.138 -6.443 -2.979 -6.16 -3.16 -5.496 c -3.406 -4.826 -3.095 -3.906 -2.325 -3.746 c -1.731 -3.623 -1.452 -4.044 -1.236 -3.882 c -1.073 -3.76 -1.168 -2.987 -0.549 -1.608 c -2.117 2.838 l -2.273 3.4 -2.268 4.087 -1.716 4.584 c 0.027 -0.026 l 1.803 4.545 l h 2.753 -4.609 m 2.392 -3.962 1.411 -4.015 1.221 -4.687 c 1.009 -5.295 1.6 -6.073 2.26 -5.879 c 2.801 -5.765 3 -5.052 2.753 -4.609 c h -1.256 -4.581 m -1.505 -3.906 -2.648 -4.02 -2.802 -4.707 c -2.96 -5.163 -2.733 -5.814 -2.196 -5.86 c -1.543 -5.949 -0.954 -5.182 -1.256 -4.581 c h";t.page.height>mm2pt(105)&&(t.save(),t.translate(this.x(105),this.y()),t.addContent(r).fillColor("black").fill(),t.restore()),t.save(),t.translate(this.x(62),this.y()+30),t.addContent(l).fillColor("black").fill(),t.restore()}this.separate&&t.page.height>mm2pt(105)&&(t.fontSize(11),t.font(this.font),t.text(translations[this.language].separate,0,this.y()-12,{align:"center",width:mm2pt(210)})),t.fontSize(11),t.font(`${this.font}-Bold`),t.text(translations[this.language].receipt,this.x(5),this.y(5),{align:"left",width:mm2pt(52)}),t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].account,this.x(5),this.y(12),{lineGap:1,width:mm2pt(52)}),t.fontSize(8),t.font(this.font),t.text(`${formatIBAN(this.data.creditor.account)}
${this.formatAddress(this.data.creditor)}`,{lineGap:-.5,width:mm2pt(52)}),t.fontSize(9),t.moveDown(),this.data.reference!==void 0&&(t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].reference,{lineGap:1,width:mm2pt(52)}),t.fontSize(8),t.font(this.font),t.text(formatReference(this.data.reference),{lineGap:-.5,width:mm2pt(52)}),t.fontSize(9),t.moveDown()),this.data.debtor!==void 0?(t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].payableBy,{lineGap:1,width:mm2pt(52)}),t.fontSize(8),t.font(this.font),t.text(this.formatAddress(this.data.debtor),{lineGap:-.5,width:mm2pt(52)})):(t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].payableByName,{lineGap:1,width:mm2pt(52)}),this.addRectangle(t,5,pt2mm(t.y-this.y()),52,20)),t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].currency,this.x(5),this.y(68),{lineGap:1,width:mm2pt(15)});const i=this.data.amount===void 0?18:27;if(t.text(translations[this.language].amount,this.x(i),this.y(68),{lineGap:1,width:mm2pt(52-i)}),t.fontSize(8),t.font(this.font),t.text(this.data.currency,this.x(5),this.y(71),{lineGap:-.5,width:mm2pt(15)}),this.data.amount!==void 0?t.text(formatAmount(this.data.amount,this.data.amountLocale),this.x(i),this.y(71),{lineGap:-.5,width:mm2pt(52-i)}):this.addRectangle(t,27,68,30,10),t.fontSize(6),t.font(`${this.font}-Bold`),t.text(translations[this.language].acceptancePoint,this.x(5),this.y(82),{align:"right",height:mm2pt(18),lineGap:1,width:mm2pt(52)}),t.fontSize(11),t.font(`${this.font}-Bold`),t.text(translations[this.language].paymentPart,this.x(67),this.y(5),{align:"left",lineGap:1,width:mm2pt(51)}),new SwissQRCode$1(this.data).attachTo(t,this.x(67),this.y(17)),t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].currency,this.x(67),this.y(68),{lineGap:1,width:mm2pt(15)}),t.text(translations[this.language].amount,this.x(89),this.y(68),{width:mm2pt(29)}),t.fontSize(10),t.font(this.font),t.text(this.data.currency,this.x(67),this.y(72),{lineGap:-.5,width:mm2pt(15)}),this.data.amount!==void 0?t.text(formatAmount(this.data.amount,this.data.amountLocale),this.x(89),this.y(72),{lineGap:-.5,width:mm2pt(29)}):this.addRectangle(t,78,72,40,15),this.data.av1!==void 0){const[r,l]=this.data.av1.split(/(\/.+)/);t.fontSize(7),t.font(`${this.font}-Bold`),t.text(r,this.x(67),this.y(90),{continued:!0,height:mm2pt(3),lineGap:1,width:mm2pt(138)}),t.font(this.font),t.text(this.data.av1.length>90?`${l.substring(0,87)}...`:l,{continued:!1})}if(this.data.av2!==void 0){const[r,l]=this.data.av2.split(/(\/.+)/);t.fontSize(7),t.font(`${this.font}-Bold`),t.text(r,this.x(67),this.y(93),{continued:!0,height:mm2pt(3),lineGap:1,width:mm2pt(138)}),t.font(this.font),t.text(this.data.av2.length>90?`${l.substring(0,87)}...`:l,{lineGap:-.5})}if(t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].account,this.x(118),this.y(5),{lineGap:1,width:mm2pt(87)}),t.fontSize(10),t.font(this.font),t.text(`${formatIBAN(this.data.creditor.account)}
${this.formatAddress(this.data.creditor)}`,{lineGap:-.75,width:mm2pt(87)}),t.fontSize(9),t.moveDown(),this.data.reference!==void 0&&(t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].reference,{lineGap:1,width:mm2pt(87)}),t.fontSize(10),t.font(this.font),t.text(formatReference(this.data.reference),{lineGap:-.75,width:mm2pt(87)}),t.fontSize(9),t.moveDown()),this.data.message!==void 0||this.data.additionalInformation!==void 0){t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].additionalInformation,{lineGap:1,width:mm2pt(87)}),t.fontSize(10),t.font(this.font);const r={lineGap:-.75,width:mm2pt(87)},l=t.heightOfString("A",r),f=getReferenceType(this.data.reference),d=f==="QRR"||f==="SCOR"?3:4,y=this.data.additionalInformation!==void 0?t.heightOfString(this.data.additionalInformation,r)/l:0;if(this.data.additionalInformation!==void 0){if(f==="QRR"||f==="SCOR")this.data.message!==void 0&&t.text(this.data.message,O($({},r),{ellipsis:!0,height:l,lineBreak:!1}));else if(this.data.message!==void 0){const s=d-y;t.text(this.data.message,O($({},r),{ellipsis:!0,height:l*s,lineBreak:!0}))}t.text(this.data.additionalInformation,r)}else this.data.message!==void 0&&t.text(this.data.message,O($({},r),{ellipsis:!0,height:l*d,lineBreak:!0}));t.fontSize(9),t.moveDown()}this.data.debtor!==void 0?(t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].payableBy,{lineGap:1,width:mm2pt(87)}),t.fontSize(10),t.font(this.font),t.text(this.formatAddress(this.data.debtor),{lineGap:-.75,width:mm2pt(87)})):(t.fontSize(8),t.font(`${this.font}-Bold`),t.text(translations[this.language].payableByName,{lineGap:1,width:mm2pt(87)}),this.addRectangle(t,118,pt2mm(t.y-this.y()),65,25))}formatAddress(t){const i=t.country!=="CH"?`${t.country} - `:"";return t.buildingNumber!==void 0?`${t.name}
${t.address} ${t.buildingNumber}
${i}${t.zip} ${t.city}`:`${t.name}
${t.address}
${i}${t.zip} ${t.city}`}addRectangle(t,i,n,r,l){t.moveTo(this.x(i+3),this.y(n)).lineTo(this.x(i),this.y(n)).lineTo(this.x(i),this.y(n+3)).moveTo(this.x(i),this.y(n+l-3)).lineTo(this.x(i),this.y(n+l)).lineTo(this.x(i+3),this.y(n+l)).moveTo(this.x(i+r-3),this.y(n+l)).lineTo(this.x(i+r),this.y(n+l)).lineTo(this.x(i+r),this.y(n+l-3)).moveTo(this.x(i+r),this.y(n+3)).lineTo(this.x(i+r),this.y(n)).lineTo(this.x(i+r-3),this.y(n)).lineWidth(.75).undash().strokeColor("black").stroke()}},_.width=mm2pt(210),_.height=mm2pt(105),_);var qrcodegen;(e=>{const f=class f{constructor(s,o,a,c){if(this.version=s,this.errorCorrectionLevel=o,this.modules=[],this.isFunction=[],s<f.MIN_VERSION||s>f.MAX_VERSION)throw"Version value out of range";if(c<-1||c>7)throw"Mask value out of range";this.size=s*4+17;const h=[];for(let u=0;u<this.size;u++)h.push(!1);for(let u=0;u<this.size;u++)this.modules.push(h.slice()),this.isFunction.push(h.slice());this.drawFunctionPatterns();const m=this.addEccAndInterleave(a);if(this.drawCodewords(m),c==-1){let u=1e9;for(let p=0;p<8;p++){this.applyMask(p),this.drawFormatBits(p);const g=this.getPenaltyScore();g<u&&(c=p,u=g),this.applyMask(p)}}r(0<=c&&c<=7),this.mask=c,this.applyMask(c),this.drawFormatBits(c),this.isFunction=[]}static encodeText(s,o){const a=e.QrSegment.makeSegments(s);return f.encodeSegments(a,o)}static encodeBinary(s,o){const a=e.QrSegment.makeBytes(s);return f.encodeSegments([a],o)}static encodeSegments(s,o,a=1,c=40,h=-1,m=!0){if(!(f.MIN_VERSION<=a&&a<=c&&c<=f.MAX_VERSION)||h<-1||h>7)throw"Invalid value";let u,p;for(u=a;;u++){const I=f.getNumDataCodewords(u,o)*8,b=l.getTotalBits(s,u);if(b<=I){p=b;break}if(u>=c)throw"Data too long"}for(const I of[f.Ecc.MEDIUM,f.Ecc.QUARTILE,f.Ecc.HIGH])m&&p<=f.getNumDataCodewords(u,I)*8&&(o=I);const g=[];for(const I of s){i(I.mode.modeBits,4,g),i(I.numChars,I.mode.numCharCountBits(u),g);for(const b of I.getData())g.push(b)}r(g.length==p);const D=f.getNumDataCodewords(u,o)*8;r(g.length<=D),i(0,Math.min(4,D-g.length),g),i(0,(8-g.length%8)%8,g),r(g.length%8==0);for(let I=236;g.length<D;I^=253)i(I,8,g);const C=[];for(;C.length*8<g.length;)C.push(0);return g.forEach((I,b)=>C[b>>>3]|=I<<7-(b&7)),new f(u,o,C,h)}getModule(s,o){return 0<=s&&s<this.size&&0<=o&&o<this.size&&this.modules[o][s]}drawFunctionPatterns(){for(let a=0;a<this.size;a++)this.setFunctionModule(6,a,a%2==0),this.setFunctionModule(a,6,a%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const s=this.getAlignmentPatternPositions(),o=s.length;for(let a=0;a<o;a++)for(let c=0;c<o;c++)a==0&&c==0||a==0&&c==o-1||a==o-1&&c==0||this.drawAlignmentPattern(s[a],s[c]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(s){const o=this.errorCorrectionLevel.formatBits<<3|s;let a=o;for(let h=0;h<10;h++)a=a<<1^(a>>>9)*1335;const c=(o<<10|a)^21522;r(c>>>15==0);for(let h=0;h<=5;h++)this.setFunctionModule(8,h,n(c,h));this.setFunctionModule(8,7,n(c,6)),this.setFunctionModule(8,8,n(c,7)),this.setFunctionModule(7,8,n(c,8));for(let h=9;h<15;h++)this.setFunctionModule(14-h,8,n(c,h));for(let h=0;h<8;h++)this.setFunctionModule(this.size-1-h,8,n(c,h));for(let h=8;h<15;h++)this.setFunctionModule(8,this.size-15+h,n(c,h));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let s=this.version;for(let a=0;a<12;a++)s=s<<1^(s>>>11)*7973;const o=this.version<<12|s;r(o>>>18==0);for(let a=0;a<18;a++){const c=n(o,a),h=this.size-11+a%3,m=Math.floor(a/3);this.setFunctionModule(h,m,c),this.setFunctionModule(m,h,c)}}drawFinderPattern(s,o){for(let a=-4;a<=4;a++)for(let c=-4;c<=4;c++){const h=Math.max(Math.abs(c),Math.abs(a)),m=s+c,u=o+a;0<=m&&m<this.size&&0<=u&&u<this.size&&this.setFunctionModule(m,u,h!=2&&h!=4)}}drawAlignmentPattern(s,o){for(let a=-2;a<=2;a++)for(let c=-2;c<=2;c++)this.setFunctionModule(s+c,o+a,Math.max(Math.abs(c),Math.abs(a))!=1)}setFunctionModule(s,o,a){this.modules[o][s]=a,this.isFunction[o][s]=!0}addEccAndInterleave(s){const o=this.version,a=this.errorCorrectionLevel;if(s.length!=f.getNumDataCodewords(o,a))throw"Invalid argument";const c=f.NUM_ERROR_CORRECTION_BLOCKS[a.ordinal][o],h=f.ECC_CODEWORDS_PER_BLOCK[a.ordinal][o],m=Math.floor(f.getNumRawDataModules(o)/8),u=c-m%c,p=Math.floor(m/c),g=[],D=f.reedSolomonComputeDivisor(h);for(let I=0,b=0;I<c;I++){const A=s.slice(b,b+p-h+(I<u?0:1));b+=A.length;const k=f.reedSolomonComputeRemainder(A,D);I<u&&A.push(0),g.push(A.concat(k))}const C=[];for(let I=0;I<g[0].length;I++)g.forEach((b,A)=>{(I!=p-h||A>=u)&&C.push(b[I])});return r(C.length==m),C}drawCodewords(s){if(s.length!=Math.floor(f.getNumRawDataModules(this.version)/8))throw"Invalid argument";let o=0;for(let a=this.size-1;a>=1;a-=2){a==6&&(a=5);for(let c=0;c<this.size;c++)for(let h=0;h<2;h++){const m=a-h,p=(a+1&2)==0?this.size-1-c:c;!this.isFunction[p][m]&&o<s.length*8&&(this.modules[p][m]=n(s[o>>>3],7-(o&7)),o++)}}r(o==s.length*8)}applyMask(s){if(s<0||s>7)throw"Mask value out of range";for(let o=0;o<this.size;o++)for(let a=0;a<this.size;a++){let c;switch(s){case 0:c=(a+o)%2==0;break;case 1:c=o%2==0;break;case 2:c=a%3==0;break;case 3:c=(a+o)%3==0;break;case 4:c=(Math.floor(a/3)+Math.floor(o/2))%2==0;break;case 5:c=a*o%2+a*o%3==0;break;case 6:c=(a*o%2+a*o%3)%2==0;break;case 7:c=((a+o)%2+a*o%3)%2==0;break;default:throw"Unreachable"}!this.isFunction[o][a]&&c&&(this.modules[o][a]=!this.modules[o][a])}}getPenaltyScore(){let s=0;for(let h=0;h<this.size;h++){let m=!1,u=0;const p=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[h][g]==m?(u++,u==5?s+=f.PENALTY_N1:u>5&&s++):(this.finderPenaltyAddHistory(u,p),m||(s+=this.finderPenaltyCountPatterns(p)*f.PENALTY_N3),m=this.modules[h][g],u=1);s+=this.finderPenaltyTerminateAndCount(m,u,p)*f.PENALTY_N3}for(let h=0;h<this.size;h++){let m=!1,u=0;const p=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][h]==m?(u++,u==5?s+=f.PENALTY_N1:u>5&&s++):(this.finderPenaltyAddHistory(u,p),m||(s+=this.finderPenaltyCountPatterns(p)*f.PENALTY_N3),m=this.modules[g][h],u=1);s+=this.finderPenaltyTerminateAndCount(m,u,p)*f.PENALTY_N3}for(let h=0;h<this.size-1;h++)for(let m=0;m<this.size-1;m++){const u=this.modules[h][m];u==this.modules[h][m+1]&&u==this.modules[h+1][m]&&u==this.modules[h+1][m+1]&&(s+=f.PENALTY_N2)}let o=0;for(const h of this.modules)o=h.reduce((m,u)=>m+(u?1:0),o);const a=this.size*this.size,c=Math.ceil(Math.abs(o*20-a*10)/a)-1;return r(0<=c&&c<=9),s+=c*f.PENALTY_N4,r(0<=s&&s<=2568888),s}getAlignmentPatternPositions(){if(this.version==1)return[];{const s=Math.floor(this.version/7)+2,o=this.version==32?26:Math.ceil((this.version*4+4)/(s*2-2))*2,a=[6];for(let c=this.size-7;a.length<s;c-=o)a.splice(1,0,c);return a}}static getNumRawDataModules(s){if(s<f.MIN_VERSION||s>f.MAX_VERSION)throw"Version number out of range";let o=(16*s+128)*s+64;if(s>=2){const a=Math.floor(s/7)+2;o-=(25*a-10)*a-55,s>=7&&(o-=36)}return r(208<=o&&o<=29648),o}static getNumDataCodewords(s,o){return Math.floor(f.getNumRawDataModules(s)/8)-f.ECC_CODEWORDS_PER_BLOCK[o.ordinal][s]*f.NUM_ERROR_CORRECTION_BLOCKS[o.ordinal][s]}static reedSolomonComputeDivisor(s){if(s<1||s>255)throw"Degree out of range";const o=[];for(let c=0;c<s-1;c++)o.push(0);o.push(1);let a=1;for(let c=0;c<s;c++){for(let h=0;h<o.length;h++)o[h]=f.reedSolomonMultiply(o[h],a),h+1<o.length&&(o[h]^=o[h+1]);a=f.reedSolomonMultiply(a,2)}return o}static reedSolomonComputeRemainder(s,o){const a=o.map(c=>0);for(const c of s){const h=c^a.shift();a.push(0),o.forEach((m,u)=>a[u]^=f.reedSolomonMultiply(m,h))}return a}static reedSolomonMultiply(s,o){if(s>>>8||o>>>8)throw"Byte out of range";let a=0;for(let c=7;c>=0;c--)a=a<<1^(a>>>7)*285,a^=(o>>>c&1)*s;return r(a>>>8==0),a}finderPenaltyCountPatterns(s){const o=s[1];r(o<=this.size*3);const a=o>0&&s[2]==o&&s[3]==o*3&&s[4]==o&&s[5]==o;return(a&&s[0]>=o*4&&s[6]>=o?1:0)+(a&&s[6]>=o*4&&s[0]>=o?1:0)}finderPenaltyTerminateAndCount(s,o,a){return s&&(this.finderPenaltyAddHistory(o,a),o=0),o+=this.size,this.finderPenaltyAddHistory(o,a),this.finderPenaltyCountPatterns(a)}finderPenaltyAddHistory(s,o){o[0]==0&&(s+=this.size),o.pop(),o.unshift(s)}};f.MIN_VERSION=1,f.MAX_VERSION=40,f.PENALTY_N1=3,f.PENALTY_N2=3,f.PENALTY_N3=40,f.PENALTY_N4=10,f.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],f.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]];let t=f;e.QrCode=t;function i(y,s,o){if(s<0||s>31||y>>>s)throw"Value out of range";for(let a=s-1;a>=0;a--)o.push(y>>>a&1)}function n(y,s){return(y>>>s&1)!=0}function r(y){if(!y)throw"Assertion error"}const d=class d{constructor(s,o,a){if(this.mode=s,this.numChars=o,this.bitData=a,o<0)throw"Invalid argument";this.bitData=a.slice()}static makeBytes(s){const o=[];for(const a of s)i(a,8,o);return new d(d.Mode.BYTE,s.length,o)}static makeNumeric(s){if(!d.isNumeric(s))throw"String contains non-numeric characters";const o=[];for(let a=0;a<s.length;){const c=Math.min(s.length-a,3);i(parseInt(s.substr(a,c),10),c*3+1,o),a+=c}return new d(d.Mode.NUMERIC,s.length,o)}static makeAlphanumeric(s){if(!d.isAlphanumeric(s))throw"String contains unencodable characters in alphanumeric mode";const o=[];let a;for(a=0;a+2<=s.length;a+=2){let c=d.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a))*45;c+=d.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a+1)),i(c,11,o)}return a<s.length&&i(d.ALPHANUMERIC_CHARSET.indexOf(s.charAt(a)),6,o),new d(d.Mode.ALPHANUMERIC,s.length,o)}static makeSegments(s){return s==""?[]:d.isNumeric(s)?[d.makeNumeric(s)]:d.isAlphanumeric(s)?[d.makeAlphanumeric(s)]:[d.makeBytes(d.toUtf8ByteArray(s))]}static makeEci(s){const o=[];if(s<0)throw"ECI assignment value out of range";if(s<128)i(s,8,o);else if(s<16384)i(2,2,o),i(s,14,o);else if(s<1e6)i(6,3,o),i(s,21,o);else throw"ECI assignment value out of range";return new d(d.Mode.ECI,0,o)}static isNumeric(s){return d.NUMERIC_REGEX.test(s)}static isAlphanumeric(s){return d.ALPHANUMERIC_REGEX.test(s)}getData(){return this.bitData.slice()}static getTotalBits(s,o){let a=0;for(const c of s){const h=c.mode.numCharCountBits(o);if(c.numChars>=1<<h)return 1/0;a+=4+h+c.bitData.length}return a}static toUtf8ByteArray(s){s=encodeURI(s);const o=[];for(let a=0;a<s.length;a++)s.charAt(a)!="%"?o.push(s.charCodeAt(a)):(o.push(parseInt(s.substr(a+1,2),16)),a+=2);return o}};d.NUMERIC_REGEX=/^[0-9]*$/,d.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,d.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let l=d;e.QrSegment=l})(qrcodegen||(qrcodegen={})),(e=>{(t=>{const n=class n{constructor(l,f){this.ordinal=l,this.formatBits=f}};n.LOW=new n(0,1),n.MEDIUM=new n(1,0),n.QUARTILE=new n(2,3),n.HIGH=new n(3,2);let i=n;t.Ecc=i})(e.QrCode||(e.QrCode={}))})(qrcodegen||(qrcodegen={})),(e=>{(t=>{const n=class n{constructor(l,f){this.modeBits=l,this.numBitsCharCount=f}numCharCountBits(l){return this.numBitsCharCount[Math.floor((l+7)/17)]}};n.NUMERIC=new n(1,[10,12,14]),n.ALPHANUMERIC=new n(2,[9,11,13]),n.BYTE=new n(4,[8,16,16]),n.KANJI=new n(8,[8,10,12]),n.ECI=new n(7,[0,0,0]);let i=n;t.Mode=i})(e.QrSegment||(e.QrSegment={}))})(qrcodegen||(qrcodegen={}));function generateQRData(e){var l,f,d,y,s,o,a;const t=cleanData(e);validateData(t);const i=(l=t.amount)==null?void 0:l.toFixed(2),n=getReferenceType(t.reference);return["SPC","0200","1",(f=t.creditor.account)!=null?f:"",...t.creditor.buildingNumber?["S",t.creditor.name,t.creditor.address,`${t.creditor.buildingNumber}`,`${t.creditor.zip}`,t.creditor.city]:["K",t.creditor.name,t.creditor.address,`${t.creditor.zip} ${t.creditor.city}`,"",""],t.creditor.country,"","","","","","","",i!=null?i:"",t.currency,...t.debtor?[...t.debtor.buildingNumber?["S",t.debtor.name,t.debtor.address,`${t.debtor.buildingNumber}`,`${t.debtor.zip}`,t.debtor.city]:["K",t.debtor.name,t.debtor.address,`${t.debtor.zip} ${t.debtor.city}`,"",""],(y=(d=t.debtor)==null?void 0:d.country)!=null?y:""]:["","","","","","",""],n,(s=t.reference)!=null?s:"",(o=t.message)!=null?o:"","EPD",(a=t.additionalInformation)!=null?a:"",...t.av1?[t.av1]:[],...t.av2?[t.av2]:[]].join(`
`)}function renderQRCode(e,t,i){const n=generateQRData(e),r=qrcodegen.QrSegment.makeEci(26),l=qrcodegen.QrSegment.makeSegments(n),f=qrcodegen.QrCode.encodeSegments([r,...l],qrcodegen.QrCode.Ecc.MEDIUM,10,25),d=t/f.size;for(let y=0;y<f.size;y++){const s=y*d;for(let o=0;o<f.size;o++){const a=o*d;f.getModule(y,o)&&i(s,a,d)}}}function renderSwissCross(e,t){const i=e/mm2pt(46),n=mm2pt(7)*i,r=mm2pt(6)*i,l=mm2pt(1.17)*i,f=mm2pt(3.89)*i;t(e/2-n/2,e/2-n/2,n,n,"white"),t(e/2-r/2,e/2-r/2,r,r,"black"),t(e/2-f/2,e/2-l/2,f,l,"white"),t(e/2-l/2,e/2-f/2,l,f,"white")}let SwissQRCode$1=class{constructor(t,i=46){this.size=mm2pt(i),this.data=cleanData(t),validateData(this.data)}attachTo(t,i=(r=>(r=t.x)!=null?r:0)(),n=(l=>(l=t.y)!=null?l:0)()){t.save(),t.translate(i,n),renderQRCode(this.data,this.size,(f,d,y)=>{t.rect(f,d,y,y)}),t.fillColor("black"),t.fill(),renderSwissCross(this.size,(f,d,y,s,o)=>{t.rect(f,d,y,s).fillColor(o).fill()}),t.restore()}};var TableLayer=(e=>(e[e.HeightCalculation=0]="HeightCalculation",e[e.PageInjection=1]="PageInjection",e[e.BackgroundColor=2]="BackgroundColor",e[e.Borders=3]="Borders",e[e.Text=4]="Text",e))(TableLayer||{});class Table{constructor(t){this.data=t}getCurrentPage(t){const i=t.page;for(let n=t.bufferedPageRange().start;n<t.bufferedPageRange().count;n++)if(t.switchToPage(n),t.page===i)return n;return t.bufferedPageRange().count}attachTo(t,i=(r=>(r=t.x)!=null?r:0)(),n=(l=>(l=t.y)!=null?l:0)()){var b,A,k,Z,X,q,K,J,tt,et,it,nt,rt,st,ot,at;if(this.data.rows===void 0)throw new Error("No table rows provided.");t.page||t.addPage({size:"A4"}),t.options.bufferPages=!0;const f=i,d=n,y=this.getCurrentPage(t),s=this.data.width?this.data.width:t.page.width-f-t.page.margins.right,o=this.data.backgroundColor?this.data.backgroundColor:void 0,a=this.data.borderWidth?this.data.borderWidth:void 0,c=this.data.borderColor?this.data.borderColor:"#000000",h=this.data.padding?this.data.padding:0,m=this.data.fontSize?this.data.fontSize:11,u=this.data.textColor?this.data.textColor:"#000000",p=this.data.fontName?this.data.fontName:"Helvetica",g=this.data.align?this.data.align:void 0,D=this.data.verticalAlign?this.data.verticalAlign:"top",C=this.data.rows.findIndex(L=>!!L.header),I=[];for(let L=0;L<Object.values(TableLayer).length/2;L++){t.switchToPage(y);let R=d;t:for(let T=0;T<this.data.rows.length;T++){const S=this.data.rows[T],V=I[T],Y=S.minHeight,H=S.maxHeight,ht=S.padding?S.padding:h,dt=S.backgroundColor?S.backgroundColor:o,ut=S.borderWidth?S.borderWidth:a,mt=S.borderColor?S.borderColor:c,pt=S.fontSize?S.fontSize:m,gt=S.fontName?S.fontName:p,It=S.textColor?S.textColor:u,yt=S.align?S.align:g,Et=S.verticalAlign?S.verticalAlign:D;t.moveTo(f,d);let w=f;e:for(let F=0;F<S.columns.length;F++){const N=S.columns[F],{remainingColumns:St,widthUsed:_t}=S.columns.reduce((E,v)=>(v.width!==void 0&&(E.widthUsed+=v.width,E.remainingColumns--),E),{remainingColumns:S.columns.length,widthUsed:0}),G=N.width?N.width:(s-_t)/St,Rt=N.padding?N.padding:ht,W=N.backgroundColor?N.backgroundColor:dt,lt=N.borderWidth?N.borderWidth:ut,U=N.borderColor?N.borderColor:mt,Nt=N.fontSize?N.fontSize:pt,bt=N.fontName?N.fontName:gt,Ct=N.textColor?N.textColor:It,Tt=N.align?N.align:yt,Q=N.verticalAlign?N.verticalAlign:Et,Dt=W===void 0?0:1,At=U===void 0?0:1,x=this._positionsToObject(Rt);t.moveTo(w+G,R);const j=O($({},(b=N.textOptions)!=null?b:{}),{align:Tt,baseline:"middle",height:V!==void 0?V-((A=x.top)!=null?A:0)-((k=x.bottom)!=null?k:0):void 0,lineBreak:!0,width:G-((Z=x.left)!=null?Z:0)-((X=x.right)!=null?X:0)});t.font(bt),t.fontSize(Nt);const z=t.heightOfString(`${N.text}`,j),P=t.heightOfString("A",j);if(L===0){if((I[T]===void 0||I[T]<z+((q=x.top)!=null?q:0)+((K=x.bottom)!=null?K:0))&&(I[T]=z+((J=x.top)!=null?J:0)+((tt=x.bottom)!=null?tt:0),Y!==void 0&&I[T]<Y&&(I[T]=Y),H!==void 0&&I[T]>H&&(I[T]=H)),S.height!==void 0&&(I[T]=S.height),F<S.columns.length-1)continue e;continue t}if(L===1&&R+V>=t.page.height-t.page.margins.bottom){t.addPage(),R=t.y;const E=this.data.rows[C];if(E!==void 0){this.data.rows.splice(T,0,E),I.splice(T,0,I[C]),T--;continue t}}if(L>1&&(S.header&&R!==((et=t.page.margins.top)!=null?et:0)&&T!==C||R+V>=t.page.height-t.page.margins.bottom)&&(t.switchToPage(this.getCurrentPage(t)+1),t.x=f,t.y=(it=t.page.margins.top)!=null?it:0,R=t.y),L===2&&W!==void 0&&t.rect(w,R,G,V).fillColor(W).fillOpacity(Dt).fill(),L===4){let E=R;Q==="top"?E=R+((nt=x.top)!=null?nt:0)+P/2:Q==="center"?E=R+V/2-z/2+P/2:Q==="bottom"&&(E=R+V-((rt=x.bottom)!=null?rt:0)-z+P/2),E<R+((st=x.top)!=null?st:0)+P/2&&(E=R+((ot=x.top)!=null?ot:0)+P/2),t.fillColor(Ct).fillOpacity(1),t.text(`${N.text}`,w+((at=x.left)!=null?at:0),E,j)}if(L===3&&lt!==void 0&&U!==void 0){const E=this._positionsToObject(lt),v=this._positionsToObject(U);if(t.undash().lineJoin("miter").lineCap("butt").strokeOpacity(At),E.left&&v.left){const B=E.bottom?E.bottom/2:0,M=E.top?E.top/2:0;t.moveTo(w,R+V+B),t.lineTo(w,R-M).strokeColor(v.left).lineWidth(E.left).stroke()}if(E.right&&v.right){const B=E.top?E.top/2:0,M=E.bottom?E.bottom/2:0;t.moveTo(w+G,R-B),t.lineTo(w+G,R+V+M).strokeColor(v.right).lineWidth(E.right).stroke()}if(E.top&&v.top){const B=E.left?E.left/2:0,M=E.right?E.right/2:0;t.moveTo(w-B,R),t.lineTo(w+G+M,R).strokeColor(v.top).lineWidth(E.top).stroke()}if(E.bottom&&v.bottom){const B=E.right?E.right/2:0,M=E.left?E.left/2:0;t.moveTo(w+G+B,R+V),t.lineTo(w-M,R+V).strokeColor(v.bottom).lineWidth(E.bottom).stroke()}}w+=G}R+=V,t.x=w,t.y=R}}t.x=f}_positionsToObject(t){return typeof t=="number"||typeof t=="string"?{bottom:t,left:t,right:t,top:t}:{bottom:t[2]!==void 0?t[2]:t[0],left:t[3]!==void 0?t[3]:t[1],right:t[1]!==void 0?t[1]:void 0,top:t[0]}}}const index$1=Object.freeze(Object.defineProperty({__proto__:null,SwissQRBill:SwissQRBill$1,SwissQRCode:SwissQRCode$1,Table},Symbol.toStringTag,{value:"Module"}));function createElement(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function convertNamedNodeMapToObject(e){const t={};for(const i of Object.keys(e))t[e[i].name]=e[i];return t}class SVGInstance{constructor(t,i){this.childInstances=[],this.element=createElement(t),this._parent=i}get parent(){return this._parent}get root(){let t=this._parent;for(;(t==null?void 0:t.parent)!==void 0;)t=t.parent;return t}appendInstance(t){return this.childInstances.push(t),this.element.appendChild(t.element),this}id(t){return typeof t=="string"?(this.element.id=t,this):this.element.id}get innerHTML(){return this.element.innerHTML}get outerHTML(){return this.element.outerHTML}empty(){return this.childInstances=[],this.element.innerHTML="",this}addClass(t){return typeof t=="string"?this.element.classList.add(t):Array.isArray(t)&&this.element.classList.add(...t),this}removeClass(t){return typeof t=="string"?this.element.classList.remove(t):Array.isArray(t)&&this.element.classList.remove(...t),this}hasClass(t){return this.element.classList.contains(t)}attr(t,i){var n;const r=Object.entries(convertNamedNodeMapToObject(this.element.attributes)).reduce((l,[f,d])=>Object.assign(Object.assign({},l),{[f]:isNaN(+d.value)?d.value:+d.value}),{});return typeof t=="undefined"?r:typeof t=="object"?Array.isArray(t)?Object.fromEntries(Object.entries(r).filter(([l,f])=>t.includes(l))):(Object.keys(t).forEach(l=>{this.element.setAttribute(l,t[l]+"")}),this):typeof t=="string"?typeof i=="undefined"?(n=r[t])!==null&&n!==void 0?n:null:(this.element.setAttribute(t,i+""),this):null}removeAttr(t){return this.element.removeAttribute(t),this}}function applyMixins(e,t){t.forEach(i=>{Object.getOwnPropertyNames(i.prototype).forEach(n=>{Object.defineProperty(e.prototype,n,Object.getOwnPropertyDescriptor(i.prototype,n)||Object.create(null))})})}class Color extends SVGInstance{color(t){if(typeof t=="undefined"){const i=this.attr("color");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("color",t),this;return null}}class Display extends SVGInstance{display(t){if(typeof t=="undefined"){const i=this.attr("display");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("display",t),this;return null}}class Fill extends SVGInstance{fill(t){if(typeof t=="undefined"){const i=this.attr("fill");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("fill",t),this;return null}fillOpacity(t){if(typeof t=="undefined"){const i=this.attr("fill-opacity");return typeof i=="number"?i:null}else if(typeof t=="number")return this.attr("fill-opacity",t),this;return null}fillRule(t){if(typeof t=="undefined"){const i=this.attr("fill-rule");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("fill-rule",t),this;return null}fillLinearGradient(t,i){var n,r,l;const f=(r=(n=this.root)===null||n===void 0?void 0:n.childInstances.find(s=>s.element.tagName==="defs"))!==null&&r!==void 0?r:(l=this.root)===null||l===void 0?void 0:l.addDefs(),d=f==null?void 0:f.addLinearGradient(),y=f.element.childNodes.length;d.attr("id","gradient-"+y),typeof i=="number"&&d.attr("gradientTransform","rotate("+i+")");for(const s of t)d.addStop(s.position,s.color);return this.attr("fill","url(#gradient-"+y+")"),this}}class Opacity extends SVGInstance{opacity(t){if(typeof t=="undefined"){const i=this.attr("opacity");return typeof i=="number"?i:null}else if(typeof t=="number")return this.attr("opacity",t),this;return null}}class Stroke extends SVGInstance{stroke(t=1,i="solid",n="currentColor"){return this.strokeWidth(t),this.strokeColor(n),i==="dashed"&&this.strokeDasharray(3),this}strokeColor(t){if(typeof t=="undefined"){const i=this.attr("stroke");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("stroke",t),this;return null}strokeLinearGradient(t,i){var n,r,l;const f=(r=(n=this.root)===null||n===void 0?void 0:n.childInstances.find(s=>s.element.tagName==="defs"))!==null&&r!==void 0?r:(l=this.root)===null||l===void 0?void 0:l.addDefs(),d=f==null?void 0:f.addLinearGradient(),y=f.element.childNodes.length;d.attr("id","gradient-"+y),typeof i=="number"&&d.attr("gradientTransform","rotate("+i+")");for(const s of t)d.addStop(s.position,s.color);return this.attr("stroke","url(#gradient-"+y+")"),this}dash(t=3,i="currentColor"){return this.strokeDasharray(t),this.strokeColor(i),this}strokeDasharray(t,i){if(typeof t=="undefined"){const n=this.attr("stroke-dasharray");if(typeof n=="number")return n;if(typeof n=="string"){const r=n.split(" ");return r.length===1?isNaN(+r[0])?r[0]:+r[0]:r.map(l=>isNaN(+l)?l:+l)}}else{if(typeof t=="string"||typeof t=="number")return this.attr("stroke-dasharray",t),this;if(Array.isArray(t))return this.attr("stroke-dasharray",t.join(" ")),this}return null}strokeDashoffset(t){return typeof t=="string"||typeof t=="number"?(this.attr("stroke-dashoffset",t),this):this.attr("stroke-dashoffset")}strokeLinecap(t){if(typeof t=="undefined"){const i=this.attr("stroke-linecap");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("stroke-linecap",t),this;return null}strokeLinejoin(t){if(typeof t=="undefined"){const i=this.attr("stroke-linejoin");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("stroke-linejoin",t),this;return null}strokeMiterlimit(t){if(typeof t=="undefined"){const i=this.attr("stroke-miterlimit");return typeof i=="number"?i:null}else if(typeof t=="number")return this.attr("stroke-miterlimit",t),this;return null}strokeOpacity(t){return typeof t=="string"||typeof t=="number"?(this.attr("stroke-opacity",t),this):this.attr("stroke-opacity")}strokeWidth(t){return typeof t=="string"||typeof t=="number"?(this.attr("stroke-width",t),this):this.attr("stroke-width")}}class VectorEffect extends SVGInstance{vectorEffect(t){if(typeof t=="undefined"){const i=this.attr("vector-effect");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("vector-effect",t),this;return null}}class Visibility extends SVGInstance{visibility(t){if(typeof t=="undefined"){const i=this.attr("visibility");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("visibility",t),this;return null}}class XYPositioning extends SVGInstance{moveTo(t,i){return this.attr("x",t),this.attr("y",i),this}moveBy(t,i){var n,r;const l=(n=this.attr("x"))!==null&&n!==void 0?n:0+t,f=(r=this.attr("y"))!==null&&r!==void 0?r:0+i;return this.moveTo(l,f)}x(t){return typeof t=="string"||typeof t=="number"?(this.attr("x",t),this):this.attr("x")}y(t){return typeof t=="string"||typeof t=="number"?(this.attr("y",t),this):this.attr("y")}}class WidthHeight extends SVGInstance{width(t){return typeof t=="string"||typeof t=="number"?(this.attr("width",t+""),this):this.attr("width")}height(t){return typeof t=="string"||typeof t=="number"?(this.attr("height",t+""),this):this.attr("height")}}class SVGRectInstance extends SVGInstance{constructor(t){super("rect",t)}borderRadius(t){return typeof t=="string"||typeof t=="number"?(this.attr("rx",t),this.attr("ry",t),this):this.attr("rx")}}applyMixins(SVGRectInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility,XYPositioning,WidthHeight]);class CXCYPositioning extends SVGInstance{cx(t){return typeof t=="string"||typeof t=="number"?(this.attr("cx",t),this):this.attr("cx")}cy(t){return typeof t=="string"||typeof t=="number"?(this.attr("cy",t),this):this.attr("cy")}}class SVGCircleInstance extends SVGInstance{constructor(t){super("circle",t)}radius(t){return typeof t=="string"||typeof t=="number"?(this.attr("r",t),this):this.attr("r")}}applyMixins(SVGCircleInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility,CXCYPositioning]);class SVGLineInstance extends SVGInstance{constructor(t){super("line",t)}x1(t){return typeof t=="string"||typeof t=="number"?(this.attr("x1",t),this):this.attr("x1")}y1(t){return typeof t=="string"||typeof t=="number"?(this.attr("y1",t),this):this.attr("y1")}x2(t){return typeof t=="string"||typeof t=="number"?(this.attr("x2",t),this):this.attr("x2")}y2(t){return typeof t=="string"||typeof t=="number"?(this.attr("y2",t),this):this.attr("y2")}}applyMixins(SVGLineInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class SVGPathInstance extends SVGInstance{constructor(t){super("path",t)}lineTo(t,i,n=!1){var r;let l=(r=this.attr("d"))!==null&&r!==void 0?r:"";return l+=n===!1?" L ":" l ",l+=` ${t}, ${i} `,this.attr("d",l),this}moveTo(t,i,n=!1){var r;let l=(r=this.attr("d"))!==null&&r!==void 0?r:"";return l+=n===!1?" M ":" m ",l+=` ${t}, ${i} `,this.attr("d",l),this}cubicBezierCurveTo(t,i,n,r,l,f,d=!1){var y;let s=(y=this.attr("d"))!==null&&y!==void 0?y:"";return s+=d===!1?" C ":" c ",s+=` ${t} ${i}, ${n} ${r}, ${l} ${f} `,this.attr("d",s),this}smoothBezierCurveTo(t,i,n,r,l=!1){var f;let d=(f=this.attr("d"))!==null&&f!==void 0?f:"";return d+=l===!1?" S ":" s ",d+=` ${t}, ${i} ${n}, ${r} `,this.attr("d",d),this}quadraticBezierCurveTo(t,i,n,r,l=!1){var f;let d=(f=this.attr("d"))!==null&&f!==void 0?f:"";return d+=l===!1?" Q ":" q ",d+=` ${t} ${i}, ${n} ${r} `,this.attr("d",d),this}smoothQuadraticBezierCurveTo(t,i,n=!1){var r;let l=(r=this.attr("d"))!==null&&r!==void 0?r:"";return l+=n===!1?" T ":" t ",l+=` ${t}, ${i} `,this.attr("d",l),this}ellipticalArcCurveTo(t,i,n,r,l,f,d,y=!1){var s;let o=(s=this.attr("d"))!==null&&s!==void 0?s:"";return o+=y===!1?" A ":" a ",o+=` ${t}, ${i} ${n} ${r?1:0} ${l?1:0} ${f} ${d} `,this.attr("d",o),this}curveTo(t,i,n,r,l=!1){var f;let d=(f=this.attr("d"))!==null&&f!==void 0?f:"";return d+=l===!1?" S ":" s ",d+=` ${t}, ${i} ${n}, ${r} `,this.attr("d",d),this}close(){var t;let i=(t=this.attr("d"))!==null&&t!==void 0?t:"";return i+=" Z",this.attr("d",i),this}}applyMixins(SVGPathInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class TextAttributes extends SVGInstance{text(t){return typeof t=="string"?(this.element.innerHTML=t,this):this.element.innerHTML}textAlign(t){var i;return t==="left"?this.textAnchor("start"):t==="center"?this.textAnchor("middle"):t==="right"?this.textAnchor("end"):(i=this.textAnchor())!==null&&i!==void 0?i:"left"}textAnchor(t){if(typeof t=="undefined"){const i=this.attr("text-anchor");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("text-anchor",t),this;return null}dx(t){return typeof t=="string"||typeof t=="number"?(this.attr("dx",t),this):this.attr("dx")}dy(t){return typeof t=="string"||typeof t=="number"?(this.attr("dy",t),this):this.attr("dy")}}class Font extends SVGInstance{fontFamily(t){if(typeof t=="undefined"){const i=this.attr("font-family");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("font-family",t),this;return null}fontSize(t){return typeof t=="string"||typeof t=="number"?(this.attr("font-size",t),this):this.attr("font-size")}fontStyle(t){if(typeof t=="undefined"){const i=this.attr("font-style");return typeof i=="string"?i:null}else if(typeof t=="string")return this.attr("font-style",t),this;return null}fontWeight(t){return typeof t=="string"||typeof t=="number"?(this.attr("font-weight",t),this):this.attr("font-weight")}}class SVGTSpanInstance extends SVGInstance{constructor(t){super("tspan",t)}addTSpan(t,i,n){const r=new SVGTSpanInstance(this);return typeof t=="string"&&typeof i=="undefined"?r.text(t):(typeof t=="string"||typeof t=="number")&&(typeof i=="string"||typeof i=="number")&&(r.attr("x",t),r.attr("y",i),typeof n=="string"&&r.text(n)),this.appendInstance(r),r}}applyMixins(SVGTSpanInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility,XYPositioning,WidthHeight,TextAttributes,Font]);class SVGTextInstance extends SVGInstance{constructor(t){super("text",t)}addTSpan(t,i,n){const r=new SVGTSpanInstance(this);return typeof t=="string"&&typeof i=="undefined"?r.text(t):(typeof t=="string"||typeof t=="number")&&(typeof i=="string"||typeof i=="number")&&(r.attr("x",t),r.attr("y",i),typeof n=="string"&&r.text(n)),this.appendInstance(r),r}}applyMixins(SVGTextInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility,XYPositioning,WidthHeight,TextAttributes,Font]);class ShapeInstances extends SVGInstance{addRect(t,i,n,r){const l=new SVGRectInstance(this);return t!==void 0&&l.attr("x",t+""),i!==void 0&&l.attr("y",i+""),n!==void 0&&l.attr("width",n+""),r!==void 0&&l.attr("height",r+""),this.appendInstance(l),l}addCircle(t,i,n){const r=new SVGCircleInstance(this);return t!==void 0&&r.attr("cx",t+""),i!==void 0&&r.attr("cy",i+""),n!==void 0&&r.attr("r",n+""),this.appendInstance(r),r}addLine(t,i,n,r){const l=new SVGLineInstance(this);return t!==void 0&&l.attr("x1",t+""),i!==void 0&&l.attr("y1",i+""),n!==void 0&&l.attr("x2",n+""),r!==void 0&&l.attr("y2",r+""),this.appendInstance(l),l}addPath(t){const i=new SVGPathInstance(this);return t!==void 0&&i.attr("d",t+""),this.appendInstance(i),i}addText(t,i,n){const r=new SVGTextInstance(this);return typeof t=="string"&&typeof i=="undefined"?r.text(t):(typeof t=="string"||typeof t=="number")&&(typeof i=="string"||typeof i=="number")&&(r.attr("x",t),r.attr("y",i),typeof n=="string"&&r.text(n)),this.appendInstance(r),r}}class SVGGroupInstance extends SVGInstance{constructor(t){super("g",t)}addGroup(){const t=new SVGGroupInstance(this);return this.appendInstance(t),t}addSVG(t,i){if(typeof t!="undefined"&&typeof i!="undefined"){const n=new SVGSVGInstance(t,i);return this.appendInstance(n),n}else{const n=new SVGSVGInstance;return this.appendInstance(n),n}}}applyMixins(SVGGroupInstance,[ShapeInstances,Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class StructuralInstances extends SVGInstance{addGroup(){const t=new SVGGroupInstance(this);return this.appendInstance(t),t}addSVG(t,i){if(typeof t!="undefined"&&typeof i!="undefined"){const n=new SVGSVGInstance(t,i);return this.appendInstance(n),n}else{const n=new SVGSVGInstance;return this.appendInstance(n),n}}}class SVGStopInstance extends SVGInstance{constructor(t){super("stop",t)}}applyMixins(SVGStopInstance,[Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class GradientStopInstances extends SVGInstance{addStop(t,i){const n=new SVGStopInstance(this);return n.attr("offset",t),n.attr("stop-color",i),this.appendInstance(n),n}}class SVGLinearGradientInstance extends SVGInstance{constructor(t){super("linearGradient",t)}}applyMixins(SVGLinearGradientInstance,[GradientStopInstances,Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class GradientInstances extends SVGInstance{addLinearGradient(){const t=new SVGLinearGradientInstance(this);return this.appendInstance(t),t}}class SVGDefsInstance extends SVGInstance{constructor(t){super("defs",t)}}applyMixins(SVGDefsInstance,[ShapeInstances,StructuralInstances,GradientInstances,Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility]);class DescriptiveInstances extends SVGInstance{addDefs(){const t=new SVGDefsInstance(this);return this.appendInstance(t),t}}class PreserveAspectRatio extends SVGInstance{preserveAspectRatio(t,i){if(typeof t=="undefined"&&typeof i=="undefined"){const n=this.attr("preserveAspectRatio");if(typeof n=="string"){const[r,l]=n.split(" ");return{align:r,meetOrSlice:l}}}else{if(typeof t=="string"&&typeof i=="string")return this.attr("preserveAspectRatio",`${t} ${i}`),this;if(typeof t=="string"&&typeof i=="undefined")return this.attr("preserveAspectRatio",t),this}return null}}class SVGSVGInstance extends SVGInstance{constructor(t,i,n){super("svg"),(typeof t=="string"||typeof t=="number")&&this.width(t),(typeof i=="string"||typeof i=="number")&&this.height(i)}addGroup(){const t=new SVGGroupInstance(this);return this.appendInstance(t),t}addSVG(t,i){if(typeof t!="undefined"&&typeof i!="undefined"){const n=new SVGSVGInstance(t,i);return this.appendInstance(n),n}else{const n=new SVGSVGInstance;return this.appendInstance(n),n}}viewBox(t,i,n,r){if(typeof t=="undefined"){const l=this.attr("viewBox");if(typeof l=="string"){const[f,d,y,s]=l.split(" ");return{x:isNaN(+f)?f:+f,y:isNaN(+d)?d:+d,width:isNaN(+y)?y:+y,height:isNaN(+s)?s:+s}}return null}else if((typeof t=="string"||typeof t=="number")&&(typeof i=="string"||typeof i=="number")&&(typeof n=="string"||typeof n=="number")&&(typeof r=="string"||typeof r=="number"))return this.attr("viewBox",`${t} ${i} ${n} ${r}`),this;return null}}applyMixins(SVGSVGInstance,[ShapeInstances,StructuralInstances,DescriptiveInstances,Color,Display,Fill,Opacity,Stroke,VectorEffect,Visibility,PreserveAspectRatio,XYPositioning,WidthHeight]);class SVG extends SVGSVGInstance{constructor(){super(),this.attr("xmlns","http://www.w3.org/2000/svg")}}function calc(expression,unit="px"){const expressionWithoutUnits=convertAbsoluteUnitsInStringToPixels(expression),sanitizedExpression=expressionWithoutUnits.replace(/[^-()\d/*+.]/g,""),result=+eval(sanitizedExpression);switch(unit){case"cm":return px2cm(result);case"mm":return px2mm(result);case"in":return px2in(result);case"pt":return px2pt(result);case"pc":return px2pc(result);case"px":return result}}function convertAbsoluteUnitsInStringToPixels(e){const t=(r,l,f,d)=>r.substr(0,f)+d+r.substr(f+l.length),i=/(-?\d*\.?\d+)(mm|cm|in|pt|pc|px)+/g;let n;for(;(n=i.exec(e))!==null;)switch(n[2]){case"cm":e=t(e,n[0],n.index,cm2px(+n[1])+"");break;case"mm":e=t(e,n[0],n.index,mm2px(+n[1])+"");break;case"in":e=t(e,n[0],n.index,in2px(+n[1])+"");break;case"pt":e=t(e,n[0],n.index,pt2px(+n[1])+"");break;case"pc":e=t(e,n[0],n.index,pc2px(+n[1])+"");break;case"px":e=t(e,n[0],n.index,+n[1]+"");break}return e}function cm2px(e){return e*9600/254}function px2cm(e){return e*254/9600}function mm2px(e){return e*960/254}function px2mm(e){return e*254/960}function in2px(e){return e*960}function px2in(e){return e/960}function pt2px(e){return e*4/3}function px2pt(e){return e/4*3}function pc2px(e){return e*16}function px2pc(e){return e/16}const arial8pt={100:6.11767578125,101:6.11767578125,102:3.05615234375,103:6.11767578125,104:6.11767578125,105:2.44384765625,106:2.44384765625,107:5.5,108:2.44384765625,109:9.1630859375,110:6.11767578125,111:6.11767578125,112:6.11767578125,113:6.11767578125,114:3.6630859375,115:5.5,116:3.05615234375,117:6.11767578125,118:5.5,119:7.94384765625,120:5.5,121:5.5,122:5.5,123:3.673828125,124:2.857421875,125:3.673828125,126:6.423828125,160:3.05615234375,161:3.6630859375,162:6.11767578125,163:6.11767578125,164:6.11767578125,165:6.11767578125,166:2.857421875,167:6.11767578125,168:3.6630859375,169:8.10498046875,170:4.0712890625,171:6.11767578125,172:6.423828125,173:0,174:8.10498046875,175:6.07470703125,176:4.39892578125,177:6.037109375,178:3.6630859375,179:3.6630859375,180:3.6630859375,181:6.337890625,182:5.908203125,183:3.6630859375,184:3.6630859375,185:3.6630859375,186:4.017578125,187:6.11767578125,188:9.173828125,189:9.173828125,190:9.173828125,191:6.71923828125,192:7.3369140625,193:7.3369140625,194:7.3369140625,195:7.3369140625,196:7.3369140625,197:7.3369140625,198:11,199:7.94384765625,200:7.3369140625,201:7.3369140625,202:7.3369140625,203:7.3369140625,204:3.05615234375,205:3.05615234375,206:3.05615234375,207:3.05615234375,208:7.94384765625,209:7.94384765625,210:8.55615234375,211:8.55615234375,212:8.55615234375,213:8.55615234375,214:8.55615234375,215:6.423828125,216:8.55615234375,217:7.94384765625,218:7.94384765625,219:7.94384765625,220:7.94384765625,221:7.3369140625,222:7.3369140625,223:6.71923828125,224:6.11767578125,225:6.11767578125,226:6.11767578125,227:6.11767578125,228:6.11767578125,229:6.11767578125,230:9.78076171875,231:5.5,232:6.11767578125,233:6.11767578125,234:6.11767578125,235:6.11767578125,236:3.05615234375,237:3.05615234375,238:3.05615234375,239:3.05615234375,240:6.11767578125,241:6.11767578125,242:6.11767578125,243:6.11767578125,244:6.11767578125,245:6.11767578125,246:6.11767578125,247:6.037109375,248:6.71923828125,249:6.11767578125,250:6.11767578125,251:6.11767578125,252:6.11767578125,253:5.5,254:6.11767578125,32:3.05615234375,33:3.05615234375,34:3.90478515625,35:6.11767578125,36:6.11767578125,37:9.78076171875,38:7.3369140625,39:2.10009765625,40:3.6630859375,41:3.6630859375,42:4.28076171875,43:6.423828125,44:3.05615234375,45:3.6630859375,46:3.05615234375,47:3.05615234375,48:6.11767578125,49:6.11767578125,50:6.11767578125,51:6.11767578125,52:6.11767578125,53:6.11767578125,54:6.11767578125,55:6.11767578125,56:6.11767578125,57:6.11767578125,58:3.05615234375,59:3.05615234375,60:6.423828125,61:6.423828125,62:6.423828125,63:6.11767578125,64:11.16650390625,65:7.3369140625,66:7.3369140625,67:7.94384765625,68:7.94384765625,69:7.3369140625,70:6.71923828125,71:8.55615234375,72:7.94384765625,73:3.05615234375,74:5.5,75:7.3369140625,76:6.11767578125,77:9.1630859375,78:7.94384765625,79:8.55615234375,80:7.3369140625,81:8.55615234375,82:7.94384765625,83:7.3369140625,84:6.71923828125,85:7.94384765625,86:7.3369140625,87:10.38232421875,88:7.3369140625,89:7.3369140625,90:6.71923828125,91:3.05615234375,92:3.05615234375,93:3.05615234375,94:5.16162109375,95:6.11767578125,96:3.6630859375,97:6.11767578125,98:6.11767578125,99:5.5},arial10pt={100:7.22998046875,101:7.22998046875,102:3.61181640625,103:7.22998046875,104:7.22998046875,105:2.88818359375,106:2.88818359375,107:6.5,108:2.88818359375,109:10.8291015625,110:7.22998046875,111:7.22998046875,112:7.22998046875,113:7.22998046875,114:4.3291015625,115:6.5,116:3.61181640625,117:7.22998046875,118:6.5,119:9.38818359375,120:6.5,121:6.5,122:6.5,123:4.341796875,124:3.376953125,125:4.341796875,126:7.591796875,160:3.61181640625,161:4.3291015625,162:7.22998046875,163:7.22998046875,164:7.22998046875,165:7.22998046875,166:3.376953125,167:7.22998046875,168:4.3291015625,169:9.57861328125,170:4.8115234375,171:7.22998046875,172:7.591796875,173:0,174:9.57861328125,175:7.17919921875,176:5.19873046875,177:7.134765625,178:4.3291015625,179:4.3291015625,180:4.3291015625,181:7.490234375,182:6.982421875,183:4.3291015625,184:4.3291015625,185:4.3291015625,186:4.748046875,187:7.22998046875,188:10.841796875,189:10.841796875,190:10.841796875,191:7.94091796875,192:8.6708984375,193:8.6708984375,194:8.6708984375,195:8.6708984375,196:8.6708984375,197:8.6708984375,198:13,199:9.38818359375,200:8.6708984375,201:8.6708984375,202:8.6708984375,203:8.6708984375,204:3.61181640625,205:3.61181640625,206:3.61181640625,207:3.61181640625,208:9.38818359375,209:9.38818359375,210:10.11181640625,211:10.11181640625,212:10.11181640625,213:10.11181640625,214:10.11181640625,215:7.591796875,216:10.11181640625,217:9.38818359375,218:9.38818359375,219:9.38818359375,220:9.38818359375,221:8.6708984375,222:8.6708984375,223:7.94091796875,224:7.22998046875,225:7.22998046875,226:7.22998046875,227:7.22998046875,228:7.22998046875,229:7.22998046875,230:11.55908203125,231:6.5,232:7.22998046875,233:7.22998046875,234:7.22998046875,235:7.22998046875,236:3.61181640625,237:3.61181640625,238:3.61181640625,239:3.61181640625,240:7.22998046875,241:7.22998046875,242:7.22998046875,243:7.22998046875,244:7.22998046875,245:7.22998046875,246:7.22998046875,247:7.134765625,248:7.94091796875,249:7.22998046875,250:7.22998046875,251:7.22998046875,252:7.22998046875,253:6.5,254:7.22998046875,32:3.61181640625,33:3.61181640625,34:4.61474609375,35:7.22998046875,36:7.22998046875,37:11.55908203125,38:8.6708984375,39:2.48193359375,40:4.3291015625,41:4.3291015625,42:5.05908203125,43:7.591796875,44:3.61181640625,45:4.3291015625,46:3.61181640625,47:3.61181640625,48:7.22998046875,49:7.22998046875,50:7.22998046875,51:7.22998046875,52:7.22998046875,53:7.22998046875,54:7.22998046875,55:7.22998046875,56:7.22998046875,57:7.22998046875,58:3.61181640625,59:3.61181640625,60:7.591796875,61:7.591796875,62:7.591796875,63:7.22998046875,64:13.19677734375,65:8.6708984375,66:8.6708984375,67:9.38818359375,68:9.38818359375,69:8.6708984375,70:7.94091796875,71:10.11181640625,72:9.38818359375,73:3.61181640625,74:6.5,75:8.6708984375,76:7.22998046875,77:10.8291015625,78:9.38818359375,79:10.11181640625,80:8.6708984375,81:10.11181640625,82:9.38818359375,83:8.6708984375,84:7.94091796875,85:9.38818359375,86:8.6708984375,87:12.27001953125,88:8.6708984375,89:8.6708984375,90:7.94091796875,91:3.61181640625,92:3.61181640625,93:3.61181640625,94:6.10009765625,95:7.22998046875,96:4.3291015625,97:7.22998046875,98:7.22998046875,99:6.5};function calculateTextWidth(e,t){let i=0;if(t==="8pt")for(let n=0;n<e.length;n++)i+=arial8pt[e.charCodeAt(n)];else if(t==="10pt")for(let n=0;n<e.length;n++)i+=arial10pt[e.charCodeAt(n)];return i}class SwissQRBill{constructor(t,i){this.scissors=!0,this.outlines=!0,this.language="DE",this.font="Arial",this.data=t,this.data=cleanData(this.data),validateData(this.data),this.language=(i==null?void 0:i.language)!==void 0?i.language:this.language,this.outlines=(i==null?void 0:i.outlines)!==void 0?i.outlines:this.outlines,this.font=(i==null?void 0:i.fontName)!==void 0?i.fontName:this.font,this.scissors=(i==null?void 0:i.scissors)!==void 0?i.scissors:this.scissors,this.instance=new SVG,this.instance.width("210mm"),this.instance.height("105mm"),this._render()}toString(){return this.instance.outerHTML}get element(){return this.instance.element}_render(){const t=this._formatAddress(this.data.creditor);let i=0,n=0;this.instance.addRect(0,0,"100%","100%").fill("#fff"),this.outlines&&this.instance.addLine("62mm","0mm","62mm","105mm").stroke(1,"dashed","black"),this.scissors&&this.instance.addSVG("11px","19px").x(calc("62mm - 5.25px")).y("30pt").addPath("M8.55299 18.3969C9.54465 17.5748 9.51074 16.0915 9.08357 14.9829L6.47473 8.02261C7.58167 5.9986 7.26467 3.99833 7.80373 3.99833C8.22582 3.99833 8.13259 4.38482 9.23105 4.32719C10.2854 4.27125 11.0652 3.1711 10.9957 2.13197C11.0025 1.09115 10.2041 0.0130391 9.1056 0.00456339C7.99867 -0.0734135 6.96972 0.858918 6.89683 1.95907C6.70527 3.24907 7.48674 5.53413 5.56613 6.60547C4.09305 5.80705 4.08797 4.38991 4.16255 3.10838C4.22358 2.04552 3.91845 0.76738 2.87424 0.260531C1.87241 -0.229367 0.446794 0.25036 0.139972 1.37594C-0.277034 2.51168 0.250156 4.07122 1.55541 4.34244C2.56233 4.55095 3.03528 3.83729 3.40143 4.1119C3.67774 4.31871 3.5167 5.62906 4.566 7.96667L1.908 15.5033C1.64356 16.456 1.65204 17.6206 2.58776 18.463L5.5424 10.6484L8.55299 18.3969ZM10.1634 2.87953C9.55143 3.97629 7.88849 3.88645 7.56641 2.74731C7.20704 1.71666 8.20887 0.397838 9.32767 0.726697C10.2447 0.919943 10.5821 2.12858 10.1634 2.87953ZM3.36753 2.927C2.94544 4.07122 1.00789 3.87797 0.746835 2.71341C0.479001 1.94042 0.8638 0.836881 1.77409 0.758904C2.88102 0.608036 3.87946 1.90821 3.36753 2.927Z").fill("black");const r=this.instance.addSVG().x("5mm").y("5mm"),l=r.addText();l.addTSpan(translations[this.language].receipt).x(0).y(0).dy("11pt").fontFamily(this.font).fontWeight("bold").fontSize("11pt"),l.addTSpan(translations[this.language].account).x(0).y("7mm").dy("9pt").fontFamily(this.font).fontWeight("bold").fontSize("6pt"),l.addTSpan(formatIBAN(this.data.creditor.account)).x(0).dy("9pt").fontFamily(this.font).fontWeight("normal").fontSize("8pt"),i++;let f=[];for(const u of t){const p=this._fitTextToWidth(u,mm2px$1(52),2,"8pt");f=[...f,...p]}for(const u of f)i++,l.addTSpan(u).x(0).dy("9pt").fontFamily(this.font).fontWeight("normal").fontSize("8pt");if(this.data.reference!==void 0&&(l.addTSpan(translations[this.language].reference).x(0).dy("18pt").fontFamily(this.font).fontWeight("bold").fontSize("6pt"),l.addTSpan(formatReference(this.data.reference)).x(0).dy("9pt").fontFamily(this.font).fontWeight("normal").fontSize("8pt"),i++),this.data.debtor!==void 0){const u=this._formatAddress(this.data.debtor);l.addTSpan(translations[this.language].payableBy).x(0).dy("18pt").fontFamily(this.font).fontWeight("bold").fontSize("6pt");let p=[];for(const g of u){const D=this._fitTextToWidth(g,mm2px$1(52),2,"8pt");p=[...p,...D]}for(const g of p)l.addTSpan(g).x(0).dy("9pt").fontFamily(this.font).fontWeight("normal").fontSize("8pt")}else{l.addTSpan(translations[this.language].payableByName).x(0).dy("18pt").fontFamily(this.font).fontWeight("bold").fontSize("6pt");const u=this.data.reference!==void 0?"18pt":"0";this._addRectangle(5,calc(`12mm + 9pt + (${i} * 9pt) + ${u} + 18pt + 1mm`,"mm"),52,20)}const d=r.addText().y("63mm");d.addTSpan(translations[this.language].currency).x(0).dy("6pt").fontFamily(this.font).fontWeight("bold").fontSize("6pt");const y=this.data.amount===void 0?13:22;d.addTSpan(translations[this.language].amount).x(`${y}mm`).fontFamily(this.font).fontWeight("bold").fontSize("6pt"),d.addTSpan(this.data.currency).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("8pt"),this.data.amount!==void 0?d.addTSpan(formatAmount(this.data.amount,this.data.amountLocale)).x(`${y}mm`).fontFamily(this.font).fontWeight("normal").fontSize("8pt"):this._addRectangle(27,68,30,10),d.addTSpan(translations[this.language].acceptancePoint).x("52mm").y("82mm").textAlign("right").fontFamily(this.font).fontWeight("bold").fontSize("6pt");const s=this.instance.addSVG().x("67mm").y("5mm");s.addText(translations[this.language].paymentPart).x(0).y(0).dy("11pt").fontFamily(this.font).fontWeight("bold").fontSize("11pt"),this._renderQRCode();const o=s.addText().y("63mm");o.addTSpan(translations[this.language].currency).x(0).dy("8pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt"),o.addTSpan(translations[this.language].amount).x("22mm").fontFamily(this.font).fontWeight("bold").fontSize("8pt"),o.addTSpan(this.data.currency).x(0).dy("13pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),this.data.amount!==void 0?o.addTSpan(formatAmount(this.data.amount,this.data.amountLocale)).x("22mm").fontFamily(this.font).fontWeight("normal").fontSize("10pt"):this._addRectangle(78,calc("68mm + 8pt + 5pt","mm"),40,15);const a=s.addText().x(0).y("90mm");if(this.data.av1!==void 0){const[u,p]=this.data.av1.split(/(\/.+)/);a.addTSpan(u).x(0).fontFamily(this.font).fontWeight("bold").fontSize("7pt"),a.addTSpan(this.data.av1.length>90?`${p.substr(0,87)}...`:p).fontFamily(this.font).fontWeight("normal").fontSize("7pt")}if(this.data.av2!==void 0){const[u,p]=this.data.av2.split(/(\/.+)/);a.addTSpan(u).x(0).dy("8pt").fontFamily(this.font).fontWeight("bold").fontSize("7pt"),a.addTSpan(this.data.av2.length>90?`${p.substr(0,87)}...`:p).fontFamily(this.font).fontWeight("normal").fontSize("7pt")}const h=this.instance.addSVG().x("118mm").y("5mm").addText();h.addTSpan(translations[this.language].account).x(0).y(0).dy("11pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt"),h.addTSpan(formatIBAN(this.data.creditor.account)).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++;let m=[];for(const u of t){const p=this._fitTextToWidth(u,mm2px$1(52),2,"8pt");m=[...m,...p]}for(const u of m)h.addTSpan(u).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++;if(this.data.reference!==void 0&&(h.addTSpan(translations[this.language].reference).x(0).dy("22pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt"),h.addTSpan(formatReference(this.data.reference)).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++),this.data.message!==void 0||this.data.additionalInformation!==void 0){h.addTSpan(translations[this.language].additionalInformation).x(0).dy("22pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt");const u=getReferenceType(this.data.reference),p=u==="QRR"||u==="SCOR"?3:4,g=mm2px$1(87);this._getLineCountOfText(this.data.message,g,"10pt");const D=this._getLineCountOfText(this.data.additionalInformation,g,"10pt");if(this.data.additionalInformation!==void 0){if(u==="QRR"||u==="SCOR")this.data.message!==void 0&&(h.addTSpan(this._ellipsis(this.data.message,g,"10pt")).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++);else if(this.data.message!==void 0){const I=p-D,b=this._fitTextToWidth(this.data.message,g,I,"10pt");for(let A=0;A<I;A++)h.addTSpan(b[A]).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++}const C=this._fitTextToWidth(this.data.additionalInformation,g,D,"10pt");for(let I=0;I<D;I++)h.addTSpan(C[I]).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++}else if(this.data.message!==void 0){const C=this._fitTextToWidth(this.data.message,g,p,"10pt");for(let I=0;I<p;I++)h.addTSpan(C[I]).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt"),n++}}if(this.data.debtor!==void 0){const u=this._formatAddress(this.data.debtor);h.addTSpan(translations[this.language].payableBy).x(0).dy("22pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt");let p=[];for(const g of u){const D=this._fitTextToWidth(g,mm2px$1(52),2,"8pt");p=[...p,...D]}for(const g of p)h.addTSpan(g).x(0).dy("11pt").fontFamily(this.font).fontWeight("normal").fontSize("10pt")}else{h.addTSpan(translations[this.language].payableByName).x(0).dy("22pt").fontFamily(this.font).fontWeight("bold").fontSize("8pt");const u=this.data.reference!==void 0?"22pt":"0",p=this.data.additionalInformation!==void 0||this.data.message!==void 0?"22pt":"0";this._addRectangle(118,calc(`5mm + 11pt + (${n} * 11pt) + ${u} + ${p} + 22pt + 1mm`,"mm"),65,25)}}_renderQRCode(){const t=new SwissQRCode(this.data);t.instance.x("67mm").y("17mm"),this.instance.appendInstance(t.instance)}_formatAddress(t){const i=t.country!=="CH"?`${t.country} - `:"";return t.buildingNumber!==void 0?[t.name,`${t.address} ${t.buildingNumber}`,`${i}${t.zip} ${t.city}`]:[t.name,t.address,`${i}${t.zip} ${t.city}`]}_getLineCountOfText(t,i,n){if(t===void 0)return 0;{let r=0,l=calculateTextWidth(t,n);for(;l>1;)r++,l-=i;return r}}_fitTextToWidth(t,i,n,r){var s;const l=t.split(/([ |-])/g);let f=[],d="";const y=o=>{const a=[];let c="";if(calculateTextWidth(o,r)>i){const h=o.split("");let m="";for(;h.length>0;)calculateTextWidth(m,r)<=i?m+=h.shift():(a.push(m),m="");m!==""&&(c=m)}else a.push(o);return{leftover:c,lines:a}};for(;l.length>0;){const o=l.shift(),a=(s=l.shift())!=null?s:"";if(calculateTextWidth(d+o+a,r)<=i)d+=o+a;else if(d!==""){const{leftover:c,lines:h}=y(d);f.push(...h),d=c+o+a}else d=o+a}if(d!==""&&d!==" "){const{leftover:o,lines:a}=y(d);f.push(...a),o!==""&&f.push(o)}return f.length>n&&(f=f.slice(0,n),f[f.length-1]=this._ellipsis(f[f.length-1],i,r)),f}_ellipsis(t,i,n){let r="";if(calculateTextWidth(t,n)>i)for(let l=0;l<t.length&&calculateTextWidth(`${r}${t[l]}...`,n)<=i;l++)r+=t[l];else return t;return r.substr(-1)===" "&&(r=r.slice(0,-1)),`${r}...`}_addRectangle(t,i,n,r){const l=this.instance.addSVG(`${n}mm`,`${r}mm`);l.x(`${t}mm`).y(`${i}mm`);const f=3;return l.addLine("0mm","0mm",`${f}mm`,"0mm").stroke(".75pt","solid","black"),l.addLine(`${n-f}mm`,"0mm",`${n}mm`,"0mm").stroke(".75pt","solid","black"),l.addLine(`${n}mm`,"0mm",`${n}mm`,`${f}mm`).stroke(".75pt","solid","black"),l.addLine(`${n}mm`,`${r-f}mm`,`${n}mm`,`${r}mm`).stroke(".75pt","solid","black"),l.addLine(`${n-f}mm`,`${r}mm`,`${n}mm`,`${r}mm`).stroke(".75pt","solid","black"),l.addLine("0mm",`${r}mm`,`${f}mm`,`${r}mm`).stroke(".75pt","solid","black"),l.addLine("0mm",`${r-f}mm`,"0mm",`${r}mm`).stroke(".75pt","solid","black"),l.addLine("0mm","0mm","0mm",`${f}mm`).stroke(".75pt","solid","black"),l}}class SwissQRCode{constructor(t,i=46){this.instance=new SVG,this.instance.width(`${i}mm`),this.instance.height(`${i}mm`),renderQRCode(t,i,(n,r,l)=>{this.instance.addRect(`${n}mm`,`${r}mm`,`${l}mm`,`${l}mm`).fill("black")}),renderSwissCross(i,(n,r,l,f,d)=>{this.instance.addRect(`${n}mm`,`${r}mm`,`${l}mm`,`${f}mm`).fill(d)})}toString(){return this.instance.outerHTML}get element(){return this.instance.element}}const index=Object.freeze(Object.defineProperty({__proto__:null,SwissQRBill,SwissQRCode},Symbol.toStringTag,{value:"Module"})),types=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));exports.errors=errors,exports.pdf=index$1,exports.svg=index,exports.types=types,exports.utils=utils,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})});
